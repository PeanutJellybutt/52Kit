var UiInputField=pc.createScript("uiInputField");UiInputField.attributes.add("textEntity",{type:"entity",title:"Text Entity",description:"The Entity that has the text Element to update with the inputted text.",default:null}),UiInputField.attributes.add("inputType",{type:"string",title:"Input Type",description:"What type of input will this field accept. On some devices, the virtual keyboard layout may change as well. For example, 'Number' will bring up a numpad instead of the full keyboard.",default:"text",enum:[{Text:"text"},{"Text (no spellcheck)":"text no spellcheck"},{Email:"email"},{Number:"number"},{Decimal:"decimal"},{Password:"password"},{Room:"room"},{Duration:"duration"},{Time:"time"},{Date:"date"},{Phone:"phone"},{Discount:"discount"},{"Pre-paid":"prepaid"}]}),UiInputField.attributes.add("enterKeyHint",{type:"string",title:"Enter Key Hint",description:"Change what the enter key shows on the virutal keyboard. Different OSs will have different representations of the hint.",default:"enter",enum:[{Enter:"enter"},{Done:"done"},{Go:"go"},{Search:"search"},{Send:"send"}]}),UiInputField.attributes.add("maxLength",{type:"number",default:32,title:"Max Length",description:"Maximum length of the text can be."}),UiInputField.attributes.add("placeHolder",{type:"string",default:"Placeholder text...",title:"Place Holder String",description:"When the inputted text is empty, what should show as placeholder? Usually this is a prompt such as 'Enter your email here'."}),UiInputField.attributes.add("placeHolderColor",{type:"rgb",title:"Place Holder Text Color",description:"What color the text should be when the placeholder string is used."}),UiInputField.attributes.add("defaultValue",{type:"number",title:"Default Value",default:2,enum:[{Zero:0},{Number:1},{"As Is":2}]}),UiInputField.prototype.initialize=function(){if(null!=this.textEntity){this._textElement=this.textEntity.element,this._textColor=this._textElement.color.clone(),this._value=this._textElement.text;let t=this._textElement.text;switch(this.defaultValue){case 0:t=0;break;case 1:t=parseInt(t.match(/\d+/)[0])}console.log(this.entity.name+" : "+this.inputType),console.log(t),this._onValueChange(t)}else this._dayElement=this.entity.findByName("Day").element,this._dateElement=this.entity.findByName("Date").element,this._monthElement=this.entity.findByName("Month").element,this._textColor=this._dateElement.color.clone(),this._value=["WED",25,"SEP"];this.setEvents("on"),this.on("destroy",(()=>{this.setEvents("off")}))},UiInputField.prototype.setEvents=function(t){this.entity[t]("uiinput:updatevalue",this._onValueChange,this),this.entity.element[t]("click",this._onClick,this)},UiInputField.prototype._onValueChange=function(t){if(this._value=t,"number"==typeof t||t.length>0){if("password"===this.inputType){let e="";for(let i=0;i<t.length;++i)e+="*";this._textElement.text=e}else if("room"===this.inputType){let e=t.toUpperCase(),i=e.replace(/[^a-zA-Z]+/g,"");i=""!=i?i[0].localeCompare("B")<=0?"B":i[0].localeCompare("K")>=0?"P":"D":"B";let n="2";if("P"!=i)if(n=e.replace(/\D/g,""),""!=n){let t=parseInt(n);n=t<=1?"1":t<=2||"B"==i?"2":"3"}else n="1";t=i+n,this._textElement.text=t,this._value=t}else if("duration"===this.inputType)t=Math.round(2*t)/2,t=Math.min(Math.max(.5,t),24),this._textElement.text=t.toString()+" HRS",this._value=t;else if("date"===this.inputType){const e=["SUN","MON","TUE","WED","THU","FRI","SAT"],i=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"];let n=new Date(t),l=[e[n.getDay()],n.getDate(),i[n.getMonth()]];this._dayElement.text=l[0],this._dateElement.text=l[1],this._monthElement.text=l[2],this._value=l}else if("phone"===this.inputType){let e="";for(let i=0;i<t.length;++i)e+=t[i],2!=i&&5!=i||(e+="-");this._textElement.text=e,this._value=e}else"discount"===this.inputType?((t=parseInt(t))>0&&(t*=-1),this._textElement.text=t.toString()+" THB",this._value=t):"prepaid"===this.inputType?(t<0&&(t*=-1),this._textElement.text=t.toString()+" THB",this._value=t):this._textElement.text=t;null!=this.textEntity&&(this._textElement.color=this._textColor),this.entity.element.color=this._textColor}else null!=this.textEntity&&(this._textElement.text=this.placeHolder,this._textElement.color=this.placeHolderColor,this.entity.element.color=this.placeHolderColor);this.entity.fire("updatedvalue",t)},UiInputField.prototype._onClick=function(t){this.app.fire("uiinput:clicked",this,t)};!function(){const e=function getIosVersion(){if(/iP(hone|od|ad)/.test(navigator.platform)){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]}return null}();document.documentElement.style.setProperty("--sat","env(safe-area-inset-top)"),document.documentElement.style.setProperty("--sab","env(safe-area-inset-bottom)"),document.documentElement.style.setProperty("--sal","env(safe-area-inset-left)"),document.documentElement.style.setProperty("--sar","env(safe-area-inset-right)");const t=pc.Application.getApplication(),n=(new Date).toJSON().slice(0,10);!function createRoomOptions(){let e=document.createElement("datalist");e.setAttribute("id","roomList"),document.body.appendChild(e);let t=document.createElement("option");t.setAttribute("value","B1"),e.appendChild(t),t=document.createElement("option"),t.setAttribute("value","B2"),e.appendChild(t),t=document.createElement("option"),t.setAttribute("value","D1"),e.appendChild(t),t=document.createElement("option"),t.setAttribute("value","D2"),e.appendChild(t),t=document.createElement("option"),t.setAttribute("value","D3"),e.appendChild(t),t=document.createElement("option"),t.setAttribute("value","P2"),e.appendChild(t)}();let i=null;function createInputDom(){i&&i.remove(),i=document.createElement("input"),i.setAttribute("type","text"),i.style.position="absolute",i.style.fontFamily="Arial, sans-serif",i.style.background="white",i.style.paddingLeft="10px",i.style.paddingRight="10px",i.style.margin="0px",i.style.visibility="hidden",i.style.zIndex=1e3,resetStyle(),i.value="",document.body.appendChild(i)}createInputDom();let l=!1,o=!1,a=null;function onInputFieldClick(e,t){t.stopPropagation(),function showDom(e,t){if(o===e)return;o&&o!==e&&onBlur();o=e,"visible"!==i.style.visibility&&(t.changedTouches?(t.event.preventDefault(),l=!1):l=!0,i.style.visibility="visible",i.onblur=onBlur,i.addEventListener("keydown",onKeyDown),i.addEventListener("keyup",onKeyUp));switch(i.value=e.value,i.maxLength=e.maxLength,i.placeholder=e.placeHolder,i.pattern=null,i.spellcheck=!1,i.min=null,i.max=null,i.step=null,i.setAttribute("list",null),e.inputType){case"text":default:i.type="text",i.spellcheck=!0,i.value="";break;case"text no spellcheck":i.type="text",i.value="";break;case"number":i.type="number",i.pattern="[0-9]*",i.value=0;break;case"decimal":i.type="number",i.value=0;break;case"email":i.type="email";break;case"password":i.type="password",i.value="";break;case"room":i.type="text",i.value="B1",i.setAttribute("list","roomList");break;case"duration":i.type="number",i.min=.5,i.max=24,i.step=.5,i.value=1;break;case"time":i.type="time",i.min="09:00",i.max="21:00",i.step=900,i.value="16:00";break;case"date":i.type="date",i.setAttribute("min",n);break;case"phone":i.type="tel",i.pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}",i.value=81234567;break;case"discount":i.type="number",i.max=0,i.value=0;break;case"prepaid":i.type="number",i.min=0,i.value=0}i.enterKeyHint=e.enterKeyHint,i.focus(),updateStyle(),o.entity.element.on("resize",updateStyle)}(e,t)}function onBlur(){i.onblur=null,i.removeEventListener("keydown",onKeyDown),i.removeEventListener("keyup",onKeyUp),i.style.visibility="hidden",function onElementSwitch(){o.entity.fire("uiinput:updatevalue",i.value),o.entity.element.off("resize",updateStyle),"password"===o.inputType&&createInputDom(),o=null}()}function onKeyDown(e){e.stopPropagation()}function onKeyUp(e){e.preventDefault(),e.stopPropagation(),13===e.keyCode&&i.blur()}function resetStyle(){const e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sal")),t=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--sar"));i.style.left="20px",i.style.height="40px",i.style.width=window.innerWidth-64-e-t+"px",i.style.fontSize="100%",i.style.top="20px",i.style.marginTop="env(safe-area-inset-top)",i.style.marginLeft="env(safe-area-inset-left)",i.style.bottom=null}function updateStyle(){if(o)if(l&&o.entity.element.screenCorners){const e=o.entity.element.screenCorners,n=Math.min(t.graphicsDevice.maxPixelRatio,window.devicePixelRatio);i.style.left=e[0].x/n-2+"px",i.style.bottom=e[0].y/n-2+"px",i.style.top=null;const l=(e[2].x-e[0].x)/n-20,a=(e[2].y-e[0].y)/n;i.style.width=l+"px",i.style.height=a+"px",i.style.fontSize=Math.round(.5*a)+"px"}else resetStyle()}function onIosResizeTimeout(){t.on("uiinput:clicked",onInputFieldClick),a=null}e?a=setTimeout(onIosResizeTimeout,2100):t.on("uiinput:clicked",onInputFieldClick),t.graphicsDevice.on("resizecanvas",(function onResize(){e&&!a&&(t.off("uiinput:clicked",onInputFieldClick),a=setTimeout(onIosResizeTimeout,2100)),setTimeout((()=>{updateStyle()}))}))}();var UiInputCycle=pc.createScript("uiInputCycle");UiInputCycle.attributes.add("maxValue",{type:"number",title:"Max Value",default:1}),UiInputCycle.prototype.initialize=function(){this._value=0,this._initColor=this.entity.element.color.clone(),this._inactiveColor=new pc.Color(.4,.4,.4,1),this._textElement=this.entity.children[0].element,this._initText=this._textElement.text,this._textColor=this._textElement.color.clone(),this._textInactiveColor=new pc.Color(.75,.75,.75,1),this.setEvents("on"),this.on("destroy",(()=>{this.setEvents("off")})),this._onValueChange()},UiInputCycle.prototype.setEvents=function(t){this.entity.element[t]("click",this._onClick,this)},UiInputCycle.prototype._onValueChange=function(){this._value>0?(this._value>1&&(this._textElement.text=this._initText+" x"+this._value.toString()),this.entity.element.color=this._initColor,this._textElement.color=this._textColor):(this._textElement.text=this._initText,this.entity.element.color=this._inactiveColor,this._textElement.color=this._textInactiveColor)},UiInputCycle.prototype._onClick=function(t){this._value++,this._value>this.maxValue&&(this._value=0),this._onValueChange()};var PageGroup=pc.createScript("pageGroup");PageGroup.attributes.add("pageIndex",{type:"number",title:"Current Page"}),PageGroup.attributes.add("maxPages",{type:"number",title:"Max Pages"}),PageGroup.attributes.add("controller",{type:"entity",title:"Controller Entity"}),PageGroup.prototype.initialize=function(){this.pos=new pc.Vec3,this.cameraEntity=this.app.root.findByName("Camera"),this._currPage=this.entity.children[this.pageIndex];this.app.touch?(this.controller.element.on("touchstart",(function(t){this._touchStartX=pc.getTouchTargetCoords(t.changedTouches[0]).x}),this),this.controller.element.on("touchend",(function(t){let e=pc.getTouchTargetCoords(t.changedTouches[0]).x,a=Math.sign(this._touchStartX-e);this.changePage(a),t.stopPropagation(),t.event.preventDefault()}),this)):this.controller.element.on("click",(function(t){this.cyclePage(),t.stopPropagation()}),this)},PageGroup.prototype.update=function(){let t=this.entity.getLocalPosition(),e=-1280*this.pageIndex;if(t.x!=e){let a=e-t.x;t.x+=a/5,(a>0&&t.x>e-1||a<0&&t.x<e+1)&&(t.x=e,this._currPage=this.entity.children[this.pageIndex]),this.entity.setLocalPosition(t)}},PageGroup.prototype.setPage=function(t){if(t!=this.pageIndex){this._currPage.fire("pageout"),this.pageIndex=t;let e=this.entity.children[t];e.enabled=!0,e.fire("pagein")}},PageGroup.prototype.changePage=function(t=1){let e=Math.max(0,Math.min(this.pageIndex+t,this.maxPages-1));this.setPage(e)},PageGroup.prototype.cyclePage=function(t=1){let e=this.pageIndex+t;e>=this.maxPages?e-=this.maxPages:e<0&&(e+=this.maxPages),this.setPage(e)};var TicketPage=pc.createScript("ticketPage");TicketPage.prototype.initialize=function(){const t=this.entity,i=t.parent.findByName("Booking Page");this.bRoom=i.findByPath("Main/Top/Room Select").script.uiInputField,this.bHrs=i.findByPath("Main/Top/Duration Input").script.uiInputField,this.bTime=i.findByPath("Main/Top/Time Select").script.uiInputField,this.bDayDate=i.findByPath("Main/Top/Date Select").script.uiInputField,this.bName=i.findByPath("Main/Middle/Name Input").script.uiInputField,this.bPhone=i.findByPath("Main/Middle/Phone Input").script.uiInputField,this.bMember=i.findByPath("Main/Middle/Member Check").script.uiInputCycle,this.bPromoName=i.findByPath("Pricing/Promotion/Promotion Input").script.uiInputField,this.bPromoAmnt=i.findByPath("Pricing/Promotion/Discount Input").script.uiInputField,this.bPrepaid=i.findByPath("Pricing/Prepaid Input").script.uiInputField,this.bMic=i.findByPath("Addons/Mic Addon").script.uiInputCycle,this.bMonitor=i.findByPath("Addons/Monitor Addon").script.uiInputCycle,this.bMixer=i.findByPath("Addons/Mixer Addon").script.uiInputCycle,this.bHead=i.findByPath("Addons/Amp Head Addon").script.uiInputCycle,this.bCab=i.findByPath("Addons/Amp Cab Addon").script.uiInputCycle,this.bCombo=i.findByPath("Addons/Amp Combo Addon").script.uiInputCycle,this.bKeys=i.findByPath("Addons/Keyboard Addon").script.uiInputCycle,this.tRoom=t.findByPath("Main/Top/Core/Room").element,this.tHrs=t.findByPath("Main/Top/Core/Duration").element,this.tDay=t.findByPath("Main/Middle/DayDate/Day").element,this.tDate=t.findByPath("Main/Middle/DayDate/Calendar/Date").element,this.tMonth=t.findByPath("Main/Middle/DayDate/Month").element,this.tTime=t.findByPath("Main/Middle/Time").element,this.tMember=t.findByPath("Main/IsMember"),this.tRoomName=t.findByPath("Pricing/Listings/Room/Item").element,this.tRoomAmnt=t.findByPath("Pricing/Listings/Room/Amount").element,this.tAddons=t.findByPath("Pricing/Listings/Addons"),this.tAddonAmnt=this.tAddons.findByName("Amount").element,this.tPromo=t.findByPath("Pricing/Listings/Promotion"),this.tPromoName=this.tPromo.findByName("Item").element,this.tPromoAmnt=this.tPromo.findByName("Amount").element,this.tTotalAmnt=t.findByPath("Pricing/Listings/Total/Amount").element,this.tMembersAmnt=t.findByPath("Pricing/Listings/Members/Amount").element,this.tPreAmnt=t.findByPath("Pricing/Prepaid/Amount").element,this.tRemAmnt=t.findByPath("Pricing/Remaining/Amount").element,this.tName=t.findByPath("Contact/Name").element,this.tPhone=t.findByPath("Contact/Phone").element,t.on("pagein",this.updateInfo,this)},TicketPage.prototype.update=function(t){},TicketPage.prototype.updateInfo=function(t){let i=this.bRoom._value;this.tRoom.text=i;let e=this.bHrs._value;this.tHrs.text=e.toString()+"HRS";let n=this.bDayDate._value;this.tDay.text=n[0],this.tDate.text=n[1],this.tMonth.text=n[2];let o=this.bTime._value.split(":");o=60*parseInt(o[0])+parseInt(o[1]);let a=(o+60*e)%1440,s=Math.floor(o/60).toString().padStart(2,"0")+":"+(o%60).toString().padStart(2,"0"),h=Math.floor(a/60).toString().padStart(2,"0")+":"+(a%60).toString().padStart(2,"0");this.tTime.text=s+" - "+h;let d=1==this.bMember._value;this.tMember.enabled=d;let m={B1:320,B2:270,D1:320,D2:270,D3:220,P2:240}[i]*e;this.tRoomName.text="Studio "+i+" (x"+e.toString()+"):",this.tRoomAmnt.text=m.toString()+" THB";let r=20*this.bMic._value+30*this.bMonitor._value+30*this.bMixer._value+30*this.bHead._value+20*this.bCab._value+30*this.bCombo._value+30*this.bKeys._value;r>0?(this.tAddonAmnt.text=r.toString()+" THB",this.tAddons.enabled=!0):this.tAddons.enabled=!1;let l=this.bPromoAmnt._value;0!=l?(this.tPromoName.text=this.bPromoName._value,this.tPromoAmnt.text=l.toString()+" THB",this.tPromo.enabled=!0):this.tPromo.enabled=!1;let P=m+r+l;this.tTotalAmnt.text=P.toString()+" THB";let u=P-10*e;this.tMembersAmnt.text=u.toString()+" THB";let p=this.bPrepaid._value;this.tPreAmnt.text=p.toString()+" THB";let y=(d?u:P)-p;this.tRemAmnt.text=y.toString()+" THB",this.tName.text=this.bName._value,this.tPhone.text=this.bPhone._value};